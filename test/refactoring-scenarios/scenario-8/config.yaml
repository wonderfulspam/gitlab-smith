name: "scenario-8"
description: "Nested template inheritance consolidation"

expectations:
  should_succeed: true
  expected_issues_resolved: 28  # Exact number expected
  max_new_issues: 2
  semantic_equivalence: false   # Complex refactoring changes semantics
  performance_improvement: true # Matrix consolidation should improve performance
  minimum_jobs_analyzed: 22     # Should parse all jobs including templates
  
  # Specific expected issues in BEFORE configuration
  expected_before_issues:
    - "Template has deep inheritance chain"
    - "Template repeats commands from parent"
    - "Multiple similar jobs could use matrix strategy"
    - "Using 'latest' tag"
    - "Potential secret in variable name"
    - "Duplicate before_script blocks"
    - "Duplicate setup configuration"
  
  # Specific expected improvements detected
  expected_improvements:
    - "Template inheritance flattening and optimization"
    - "Matrix strategy implementation for similar jobs"
    - "Redundant command removal from templates"
    - "Security improvements for image tags and variables"
    - "Template complexity reduction"
  
  # Expected improvement tags
  expected_improvement_tags:
    - "templates"
    - "extends"
    - "matrix"
    - "redundancy"
    - "consolidation"
    - "variables"
  
  # Expected remaining issues in AFTER configuration
  expected_remaining_issues:
    - "Using 'latest' tag"
    - "Artifacts configured without expiration"